<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:cc="http://xmlns.jcp.org/jsf/composite"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:cyk_jsf="http://jsf.web.utility.cyk.org">
	
	<style>
		.weightInKiloGramOfProductLostIsNotNormal{
			background: yellow !important;
		}
	</style>
	
	<p:dataTable value="#{deliveries}" var="delivery"
		rowStyleClass="#{delivery.weightInKiloGramOfProductLost > delivery.weightInKiloGramOfProductLostable ? 'weightInKiloGramOfProductLostIsNotNormal' : ''}"
	>
		<p:columnGroup type="header">
			<p:row>
				<p:column headerText="Camion" colspan="2"/>
				<p:column headerText="Chargement" colspan="5"/>
				<p:column headerText="Déchargement" colspan="3"/>
				<p:column headerText="Perte" rowspan="3"/>
				<p:column headerText="Durée" rowspan="3"/>
				<p:column headerText="Actions" rowspan="3"/>
			</p:row>
			<p:row>
				<!-- Camion -->
				<p:column headerText="Immatriculation" rowspan="2"/>
				<p:column headerText="Conducteur" rowspan="2"/>
				<!-- Loading -->
				<p:column headerText="Produit" rowspan="2"/>
				<p:column headerText="Destination" rowspan="2"/>
				<p:column headerText="Poids" colspan="3"/>				
				<!-- Unloading -->
				<p:column headerText="Poids" colspan="3"/>
			</p:row>
			<p:row>
				<p:column headerText="Avant"/>				
				<p:column headerText="Après"/>
				<p:column headerText="Différence"/>
				<!-- Unloading -->
				<p:column headerText="Avant"/>
				<p:column headerText="Après"/>
				<p:column headerText="Différence"/>
			</p:row>
		</p:columnGroup>
		<!-- Camion -->
  		<p:column><h:outputText value="#{delivery.truck}" /></p:column>
  		<p:column><h:outputText value="#{delivery.driver.person.firstName} #{delivery.driver.person.lastNames}" /></p:column>
  		<!-- Loading -->
  		<p:column><h:outputText value="#{delivery.getTaskAt(1).product}" /></p:column>
  		<p:column><h:outputText value="#{delivery.getTaskAt(1).unloadingPlace}" /></p:column>
  		<p:column><h:outputText value="#{delivery.getTaskAt(0).weightInKiloGram}" /></p:column>
  		<p:column><h:outputText value="#{delivery.getTaskAt(2).weightInKiloGram}" /></p:column>
  		<p:column><h:outputText value="#{delivery.weightInKiloGramOfProductAfterLoad}" /></p:column>
  		<!-- Unloading -->
  		<p:column><h:outputText value="#{delivery.getTaskAt(3).weightInKiloGram}" /></p:column>
  		<p:column><h:outputText value="#{delivery.getTaskAt(4).weightInKiloGram}" /></p:column>
  		<p:column><h:outputText value="#{delivery.weightInKiloGramOfProductAfterUnload}" /></p:column>
  		<!-- Loss -->
  		<p:column><h:outputText value="#{delivery.weightInKiloGramOfProductLost}|#{delivery.weightInKiloGramOfProductLostable}" /></p:column>
  		<!-- Duration -->
  		<p:column><h:outputText value="#{cyk_jsf:formatDurationTillNow(delivery.getTaskAt(2).existence.creationDate)}|#{delivery.path.durationInMinute}" /></p:column>
  		<!-- Actions -->
  		<p:column>
  			<p:button value="Détails" icon="fa fa-eye" outcome="deliveryReadView">
  				<f:param name="entityidentifier" value="#{delivery.identifier}"/>
  			</p:button>
  		</p:column>
  	</p:dataTable>	

</ui:composition>